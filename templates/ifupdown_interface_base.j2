{% if not network_interface_single_configuration_file %}
# {{ ansible_managed }}

{% endif %}
{#
## Decide where to put additional condiguration,
## like "debian_command_options" or bonding options,
## in case there are multiple IP families defined.
#}
{# {% if (item.addresses | default([]) | ansible.utils.ipv4) #}
{#   or (item.dhcp4 is defined and item.dhcp4 ) %} #}
{# {%   set default_family = 'inet' %} #}
{# {% elif (item.addresses | default([]) | ansible.utils.ipv6 ) %} #}
{# {%   set default_family = 'inet6' %} #}
{# {% else %} #}
{# {%   set default_family = 'inet' %} #}
{# {% endif %} #}
{% set default_family = None %}
{% if (item.addresses | default([]) | ansible.utils.ipv4)
       or (item.dhcp4 is defined and item.dhcp4 ) %}
{%   set add_family_inet = True %}
{%   set default_family = 'inet' %}
{% endif %}
{% if (item.addresses | default([]) | ansible.utils.ipv6 ) %}
{%   if default_family is none %}
{%     set default_family = 'inet6' %}
{%   endif %}
{%   set add_family_inet6 = True %}
{% endif %}
{% if default_family is none %}
{%   set add_family_inet = True %}
{%   set default_family = 'inet' %}
{% endif %}
{% from "ifupdown_macros.j2" import def_iface with context %}
{% block interface_selection %}
{{ item.backend.ifupdown.selection | default('auto') }} {{ item.device }}
{% endblock %}
{% block interfaces %}
{% if add_family_inet | default(False) %}
{{ def_iface(type, 'inet', item) }}
{% endif %}
{% if add_family_inet6 | default(False) %}
{{ def_iface(type, 'inet6', item) }}
{% endif %}
{% endblock %}
